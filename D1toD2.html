
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en-US">
<!--
    Copyright (c) 1999-2015 by Digital Mars
    All Rights Reserved Written by Walter Bright
    http://digitalmars.com
  -->
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="D programming language" />
    <meta name="description" content="D Programming Language" />
    <title>Migrating D1 Code to D2 - D Programming Language</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/pure-min.css">
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/grids-responsive-old-ie-min.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/grids-responsive-min.css">
    <!--<![endif]-->

    <link rel="stylesheet" type="text/css" href="css/code.css" />
    <link rel="stylesheet" type="text/css" href="css/styles.css">

    <link rel="stylesheet" type="text/css" href="css/print.css" media="print" />
    <link rel="shortcut icon" href="favicon.ico" />
</head>

<body id='Migrating D1 Code to D2'>
    <header>
        <div class="container">
            <nav class="pure-menu pure-menu-open pure-menu-horizontal">
                <a href="#" class="pure-menu-heading"><img class="d-logo" width="125" height="95" border="0" alt="D Logo" src="images/dlogo.png"></a>

                <ul>
                    <li><a href="index.html">Overview</a></li>
                    <li><a href="#">FAQ</a></li>
                    <li><a href="spec.html">Docs</a></li>
                    <li><a href="#">Blog</a></li>
                    <li><a href="#">Forums</a></li>
                    <li><a href="#">GitHub</a></li>
                </ul>

                <form class="search-form pure-form" method="get" action="http://google.com/search">
                    <input type="text" class="pure-input-rounded" name="search" placeholder="search">
                    <input type="hidden" id="domains" name="domains" value="dlang.org" />
                    <input type="hidden" id="sourceid" name="sourceid" value="google-search" />
                </form>
            </nav>
        </div>
    </header>

<!--Generated by Ddoc from D1toD2.dd-->



<section class="container pure-g">
<div class="api-navigation pure-u-1-5">
<div class="pure-menu pure-menu-open"><ul><li><span class="pure-menu-heading" href="index.html" title="D Programming Language">D </span></li>
    <li><a href="download.html" title="Download a D compiler"><span class="emph">Download</span></a></li>
    <li><a href="overview.html" title="D language overview">Overview</a></li>
    <li><a href="comparison.html" title="D feature list">Features</a></li>
    <li><a href="changelog.html" title="History of changes to D">Change Log</a></li>
    <li><a href="bugstats.php" title="D issue and bug tracking system">Bug Tracker</a></li>
    <li><a href="faq.html" title="Frequently Asked Questions">FAQ</a></li>
    <li><a href="appendices.html">Appendices</a></li>
    <li><a href="acknowledgements.html" title="Thank-you to these people who have helped with D">Acknowledgments</a></li>
    <li><a href="sitemap.html" title="Documents on this site, indexed alphabetically">Sitemap</a></li>
    <li><a href="http://digitalmars.com/d/1.0/index.html" title="D Programming Language 1.0">D1 Home</a></li>
 </ul></div>
<div class="pure-menu pure-menu-open"><ul><li><span class="pure-menu-heading" href="#">Documentation</span></li>
    <li><a href="http://ddili.org/ders/d.en/index.html.html">Online Book (free)</a></li>
    <li><a href="http://wiki.dlang.org/Books" title="D Programming Language Books">More Books</a></li>

    <li><a href="language-reference.html">Language Reference</a></li>
    <li><a href="phobos/index.html.html">Library Reference</a></li>
    <li><a href="library/index.html.html">&nbsp;<font size=-1><span style="visibility: hidden">3</span>Preview new Layout</font></a></li>

    <li><a href="howtos.html" title="Helps for using D">How-tos</a></li>
    <li><a href="articles.html">Articles</a></li>
 </ul></div>
<div class="pure-menu pure-menu-open"><ul><li><span class="pure-menu-heading" href="#"><a href="http://rainers.github.io/visuald/visuald/StartPage.html">Visual D</a></span></li>
 </ul></div>
<div class="pure-menu pure-menu-open"><ul><li><span class="pure-menu-heading" href="#">Community</span></li>
    <li><a href="http://forum.dlang.org/" title="User forums">Forums</a></li>
    <li><a href="http://github.com/D-Programming-Language" title="D on github">GitHub</a></li>
    <li><a href="http://wiki.dlang.org" title="Wiki for the D Programming Language">Wiki</a></li>
    <li><a href="http://wiki.dlang.org/Review_Queue" title="Queue of current and upcoming standard library additions">Review Queue</a></li>
    <li><a href="http://code.dlang.org" title="Third party packages written in D">Third Party Packages</a></li>
    <li><a href="http://twitter.com/#search?q=%23d_lang" title="#d_lang on twitter.com">Twitter</a></li>
    <li><a href="http://digitalmars.com/d/dlinks.html" title="External D related links">Links</a></li>
 </ul></div></div>
<div class="api-content pure-u-4-5"><div class="body-box">
<div id="tools">
	<span class="tip">
		<a href="https://github.com/D-Programming-Language/dlang.org/edit/master/D1toD2.dd" class="button">Improve this page</a>
		<span 			Quickly fork>edit online, and submit a pull request for this page.
			Requires a signed-in GitHub account. This works well for small changes.
			If you'd like to make larger changes you may want to consider using
			local clone.
		</span>
	</span>
	<span class="tip">
		<a href="http://wiki.dlang.org/DocComments/D1toD2" class="button">Page wiki</a>
		<span 			View or edit the community-maintained wiki page associated with this page.
		></span>
	</span>
</div> <h1>Migrating D1 Code to D2</h1> 
	<p>There are many changes to the D programming language that affect
	migrating source code from D1 to D2.
	This is an outline of changes to look for and a guide to how to modify
	the code.
	See <a href="features2.html">D 2.0 Enhancements</a> for a complete list
	of changes to the language.
	</p>

	<p>This document is incomplete.</p>

<ul>    <li>Core Language
    <ul>	<li><a class="anchor" title="Permalink" href="#new_keywords">New Keywords</a></li>
	<li><a class="anchor" title="Permalink" href="#global_variables">Global Variables</a></li>
	<li><a class="anchor" title="Permalink" href="#static_arrays">Static Arrays are now Value Types</a></li>
	<li><a class="anchor" title="Permalink" href="#immutable_string">String Literals are Immutable</a></li>
    </ul>
    </li>

    <li>Phobos Library
    <ul>    </ul>
    </li>
</ul>

<hr><h3><a name="new_keywords"></a>New Keywords</h3>

	<p>D2 adds the following keywords:
	<span class="d_keyword">pure</span>,
	<span class="d_keyword">nothrow</span>,
	<span class="d_keyword">shared</span>, and
	<span class="d_keyword">immutable</span>.
	Any use of them in D1 code must be renamed.
	Any variable names starting with two underscores
	should be renamed.
	</p>

<hr><h3><a name="global_variables"></a>Global Variables</h3>

	<p>Global variables are now, by default, stored in thread local
	storage. To put them back in global storage, use the <span class="d_keyword">__gshared</span>
	storage class:</p>

<pre class="d_code notranslate"><span class="d_keyword">int</span> foo = 7; <span class="d_comment">// D1 code
</span><b><span class="d_keyword">__gshared</span></b> <span class="d_keyword">int</span> foo = 7; <span class="d_comment">// D2 equivalent
</span></pre>

	<p>Carefully consider whether or not those variables actually should
	go into thread local storage, rather than being implicitly shared
	among all threads.
	</p>

<hr><h3><a name="static_arrays"></a>Static Arrays are now Value Types</h3>

	<p>In D1, a static array function parameter is passed by
	reference, meaning a pointer to the start of the static array
	is passed as an argument.
	This means that any changes to the array contents made by the
	function will be visible to the function's caller.
	In D2, a copy of the whole static
	array is passed as an argument. Changes to the array contents by
	the function are not visible to the function's caller, as it is
	a separate copy.</p>

	<p>To migrate, add the keyword <span class="d_keyword">ref</span> to the parameter
	declaration:</p>

<pre class="d_code notranslate"><span class="d_keyword">void</span> foo(<span class="d_keyword">int</span>[3] array);      <span class="d_comment">// D1 code
</span><span class="d_keyword">void</span> foo(<b><span class="d_keyword">ref</span></b> <span class="d_keyword">int</span>[3] array);  <span class="d_comment">// D2 equivalent
</span></pre>

<hr><h3><a name="immutable_string"></a>String Literals are Immutable</h3>

	<p>String literals in D1 have type <span class="d_inlinecode donthyphenate notranslate">char[]</span>, but in D2 they
	have type <span class="d_inlinecode donthyphenate notranslate">immutable(char)[]</span>, which is aliased for convenience
	under the name <span class="d_inlinecode donthyphenate notranslate">string</span>.  To migrate usually involves doing a
	global search replace: </p>

	<table>	<tr><th scope="col">from</th><th scope="col">to</th></tr>
	<tr><td>char[]</td><td>string</td></tr>
	<tr><td>wchar[]</td><td>wstring</td></tr>
	<tr><td>dchar[]</td><td>dstring</td></tr>
	</table>

	<p>This will take care of most of the issues.
	For the rest, where mutable strings are desired, there will
	be some work necessary.
	</p>

</div></div>
</section>


<div id="copyright">Copyright &copy; 1999-2015 by Digital Mars &reg;, All Rights Reserved | Page generated by <a href="http://dlang.org/ddoc.html">Ddoc</a> on Mon Jan 19 23:23:04 2015
</div>
</body>
</html>
